{% extends 'base.html' %}
{% block title %}Ticket{% endblock %}
{% block content %}
<h2>Ticket</h2>
<form method="get" action="{{ url_for('tickets') }}" class="filters">
    <label for="status">Stato:</label>
    <select name="status" id="status" onchange="this.form.submit()">
        <option value="" {% if not selected_status %}selected{% endif %}>Tutti</option>
        {% for status in statuses %}
        <option value="{{ status }}" {% if status == selected_status %}selected{% endif %}>{{ status }}</option>
        {% endfor %}
    </select>
    <noscript><button type="submit">Filtra</button></noscript>
</form>
<p><a class="button" href="{{ url_for('add_ticket', **current_filters) }}">Nuovo ticket</a></p>
{% if tickets %}
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Cliente</th>
        <th>Oggetto</th>
        <th>Stato</th>
        <th>Creato il</th>
    </tr>
    </thead>
    <tbody>
    {% for ticket in tickets %}
    <tr>
        <td><a href="{{ url_for('ticket_detail', ticket_id=ticket['id']) }}">{{ ticket['id'] }}</a></td>
        <td>{{ ticket['customer_name'] }}</td>
        <td>{{ ticket['subject'] }}</td>
        <td>{{ ticket['status'] }}</td>
        <td>{{ ticket['created_at'] }}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>Nessun ticket presente.</p>
{% endif %}
{% endblock %}
